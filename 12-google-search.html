<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Australian University Course Lookup</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #eef1f7;
            min-height: 100vh;
            padding: 24px 16px;
        }

        .container {
            max-width: 860px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #00356b 0%, #003f8a 100%);
            color: white;
            padding: 32px 36px;
            border-radius: 16px 16px 0 0;
            display: flex;
            align-items: flex-start;
            gap: 20px;
        }

        .header-icon {
            font-size: 2.8rem;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .header-text h1 {
            font-size: 1.85rem;
            font-weight: 600;
            letter-spacing: -0.3px;
            margin-bottom: 6px;
        }

        .header-text p {
            opacity: 0.82;
            font-size: 0.98rem;
            line-height: 1.5;
        }

        .live-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255,184,0,0.2);
            border: 1px solid rgba(255,184,0,0.5);
            color: #FFD055;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            padding: 4px 10px;
            border-radius: 20px;
            margin-top: 10px;
        }

        .live-dot {
            width: 6px;
            height: 6px;
            background: #FFB800;
            border-radius: 50%;
            animation: pulse 1.8s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* API Key */
        .api-key-section {
            background: white;
            padding: 18px 24px;
            border-left: 1px solid #d8dde8;
            border-right: 1px solid #d8dde8;
            border-bottom: 1px solid #e8eaf0;
        }

        .api-key-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .api-key-label {
            font-size: 0.82rem;
            font-weight: 600;
            color: #555;
            white-space: nowrap;
        }

        #apiKeyInput {
            flex: 1;
            padding: 9px 14px;
            border: 1.5px solid #d0d5e0;
            border-radius: 8px;
            font-size: 0.88rem;
            transition: border-color 0.2s;
            background: #fafbfc;
        }

        #apiKeyInput:focus {
            outline: none;
            border-color: #00356b;
            background: white;
        }

        #saveApiKey {
            padding: 9px 20px;
            background: #00356b;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.88rem;
            font-weight: 500;
            transition: background 0.2s;
            white-space: nowrap;
        }

        #saveApiKey:hover {
            background: #002a54;
        }

        .api-status {
            margin-top: 8px;
            font-size: 0.8rem;
            color: #888;
        }

        .api-status.success { color: #1a7a4a; font-weight: 500; }
        .api-status.error { color: #c0392b; }

        /* Main content */
        .main-section {
            background: white;
            border-left: 1px solid #d8dde8;
            border-right: 1px solid #d8dde8;
            padding: 28px 28px;
        }

        /* Quick questions */
        .quick-title {
            font-size: 0.82rem;
            font-weight: 600;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            margin-bottom: 12px;
        }

        .quick-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 24px;
        }

        .quick-btn {
            padding: 8px 14px;
            background: #f0f4fb;
            border: 1.5px solid #c8d3e8;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.82rem;
            color: #003580;
            font-weight: 500;
            transition: all 0.18s;
            text-align: left;
            line-height: 1.3;
        }

        .quick-btn:hover {
            background: #00356b;
            border-color: #00356b;
            color: white;
        }

        /* Question input */
        .input-group {
            margin-bottom: 16px;
        }

        .input-label {
            display: block;
            font-size: 0.88rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        #questionInput {
            width: 100%;
            min-height: 80px;
            padding: 14px 16px;
            border: 1.5px solid #d0d5e0;
            border-radius: 10px;
            font-size: 0.97rem;
            font-family: inherit;
            line-height: 1.55;
            resize: vertical;
            transition: border-color 0.2s;
            background: #fafbfc;
        }

        #questionInput:focus {
            outline: none;
            border-color: #00356b;
            background: white;
        }

        .search-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #00356b, #0052a5);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s, transform 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .search-btn:hover:not(:disabled) {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .search-btn:disabled {
            background: #b0b8c8;
            cursor: not-allowed;
            transform: none;
        }

        /* Divider */
        .divider {
            border: none;
            border-top: 1px solid #eaecf2;
            margin: 28px 0;
        }

        /* Results */
        .results-area {
            min-height: 200px;
        }

        .results-placeholder {
            text-align: center;
            color: #aab;
            padding: 48px 20px;
            font-size: 0.95rem;
        }

        .results-placeholder .ph-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
            display: block;
        }

        .loading-state {
            text-align: center;
            padding: 48px 20px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #e0e4ef;
            border-top-color: #00356b;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: #555;
            font-size: 0.95rem;
        }

        .loading-subtext {
            color: #aaa;
            font-size: 0.82rem;
            margin-top: 6px;
        }

        /* Answer card */
        .answer-card {
            background: #f7f9ff;
            border: 1.5px solid #c8d3eb;
            border-radius: 12px;
            padding: 22px 24px;
            margin-bottom: 20px;
        }

        .answer-label {
            font-size: 0.78rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            color: #00356b;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .answer-text {
            font-size: 0.97rem;
            line-height: 1.72;
            color: #222;
            white-space: pre-wrap;
        }

        /* Search queries */
        .queries-row {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .queries-label {
            font-size: 0.78rem;
            font-weight: 600;
            color: #888;
            white-space: nowrap;
            margin-top: 2px;
        }

        .query-chip {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            background: #f0f4fb;
            border: 1px solid #ccd4e8;
            border-radius: 20px;
            font-size: 0.78rem;
            color: #334;
        }

        /* Sources */
        .sources-section {
            border-top: 1px solid #eaecf2;
            padding-top: 20px;
        }

        .sources-heading {
            font-size: 0.88rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 7px;
        }

        .source-count {
            background: #00356b;
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 2px 7px;
            border-radius: 10px;
        }

        .sources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 10px;
        }

        .source-card {
            background: white;
            border: 1.5px solid #e0e5f0;
            border-radius: 10px;
            padding: 12px 14px;
            transition: border-color 0.18s, box-shadow 0.18s;
            text-decoration: none;
            display: block;
        }

        .source-card:hover {
            border-color: #00356b;
            box-shadow: 0 2px 8px rgba(0,53,107,0.1);
        }

        .source-favicon {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            margin-right: 6px;
            vertical-align: middle;
            flex-shrink: 0;
        }

        .source-title-text {
            font-size: 0.84rem;
            font-weight: 600;
            color: #003580;
            line-height: 1.35;
            margin-bottom: 5px;
            display: flex;
            align-items: flex-start;
            gap: 6px;
        }

        .source-url-text {
            font-size: 0.75rem;
            color: #888;
            word-break: break-all;
            line-height: 1.3;
        }

        /* Disclaimer */
        .disclaimer {
            margin-top: 18px;
            padding: 12px 16px;
            background: #fffbec;
            border: 1px solid #ffe082;
            border-radius: 8px;
            font-size: 0.78rem;
            color: #7a6000;
            line-height: 1.5;
        }

        /* Footer */
        .footer {
            background: #1a2642;
            color: rgba(255,255,255,0.5);
            text-align: center;
            padding: 16px 20px;
            font-size: 0.78rem;
            border-radius: 0 0 16px 16px;
            border: 1px solid #d8dde8;
            border-top: none;
        }

        .error-card {
            background: #fdf2f2;
            border: 1.5px solid #f5c6c6;
            border-radius: 10px;
            padding: 18px 20px;
            color: #c0392b;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        @media (max-width: 600px) {
            .header { padding: 24px 20px; flex-direction: column; gap: 10px; }
            .header-text h1 { font-size: 1.4rem; }
            .api-key-row { flex-wrap: wrap; }
            #saveApiKey { width: 100%; }
            .main-section { padding: 20px 16px; }
            .sources-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-icon">üéì</div>
            <div class="header-text">
                <h1>Australian University Course Lookup</h1>
                <p>Ask questions about courses, prerequisites, enrolment policies, and campus info at Australian universities ‚Äî answered with live web search.</p>
                <div class="live-badge">
                    <span class="live-dot"></span>
                    REAL-TIME SEARCH ¬∑ Powered by Gemini + Google Search
                </div>
            </div>
        </div>

        <div class="api-key-section">
            <div class="api-key-row">
                <span class="api-key-label">API Key</span>
                <input type="password" id="apiKeyInput" placeholder="Enter your Google AI Studio API key..." maxlength="200">
                <button id="saveApiKey">Save</button>
            </div>
            <div class="api-status" id="apiStatus">Enter your Google AI API key from <a href="https://aistudio.google.com/apikey" target="_blank">aistudio.google.com</a> to get started</div>
        </div>

        <div class="main-section">
            <div class="quick-title">Quick questions ‚Äî click to try</div>
            <div class="quick-buttons">
                <button class="quick-btn" data-q="What are the prerequisites for COMP2100 at ANU?">Prerequisites for COMP2100 at ANU</button>
                <button class="quick-btn" data-q="When does Semester 1 2025 start at the University of Melbourne?">Semester 1 2025 start at UniMelb</button>
                <button class="quick-btn" data-q="What WAM is required for an honours year at UNSW?">WAM required for UNSW honours</button>
                <button class="quick-btn" data-q="Does Monash University offer a Bachelor of Data Science?">Monash Bachelor of Data Science</button>
                <button class="quick-btn" data-q="What student services does UQ offer for exam special consideration?">UQ exam special consideration process</button>
            </div>

            <div class="input-group">
                <label class="input-label" for="questionInput">Your question</label>
                <textarea
                    id="questionInput"
                    placeholder="e.g. What are the entry requirements for a Doctor of Medicine at the University of Sydney?"
                ></textarea>
            </div>

            <button class="search-btn" id="searchBtn" disabled>
                <span>üîç</span> Search with Live Web Results
            </button>

            <hr class="divider">

            <div class="results-area" id="resultsArea">
                <div class="results-placeholder">
                    <span class="ph-icon">üè´</span>
                    Your answer will appear here, with sources so you can verify the information
                </div>
            </div>
        </div>

        <div class="footer">
            Answers are generated using the Gemini API with Google Search grounding ‚Äî always verify important enrolment decisions with your university directly.
        </div>
    </div>

    <script type="module">
        import { GoogleGenAI } from "https://esm.sh/@google/genai@latest";

        let apiKey = localStorage.getItem('googleAiApiKey') || '';
        let ai = null;

        const apiKeyInput = document.getElementById('apiKeyInput');
        const saveApiKeyBtn = document.getElementById('saveApiKey');
        const apiStatus = document.getElementById('apiStatus');
        const questionInput = document.getElementById('questionInput');
        const searchBtn = document.getElementById('searchBtn');
        const resultsArea = document.getElementById('resultsArea');

        function initializeAI(key) {
            try {
                ai = new GoogleGenAI({ apiKey: key });
                apiStatus.textContent = '‚úÖ API key saved ‚Äî ready to search';
                apiStatus.className = 'api-status success';
                searchBtn.disabled = false;
            } catch (e) {
                apiStatus.textContent = '‚ùå Could not initialise with that key ‚Äî check and try again';
                apiStatus.className = 'api-status error';
                searchBtn.disabled = true;
                ai = null;
            }
        }

        if (apiKey) {
            apiKeyInput.value = apiKey;
            initializeAI(apiKey);
        }

        saveApiKeyBtn.addEventListener('click', () => {
            const key = apiKeyInput.value.trim();
            if (!key) {
                apiStatus.textContent = 'Please paste a valid API key';
                apiStatus.className = 'api-status error';
                return;
            }
            apiKey = key;
            localStorage.setItem('googleAiApiKey', apiKey);
            initializeAI(apiKey);
        });

        // Quick-question buttons
        document.querySelectorAll('.quick-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                questionInput.value = btn.dataset.q;
                questionInput.focus();
            });
        });

        searchBtn.addEventListener('click', runSearch);
        questionInput.addEventListener('keydown', e => {
            if (e.key === 'Enter' && (e.metaKey || e.ctrlKey)) runSearch();
        });

        async function runSearch() {
            const question = questionInput.value.trim();
            if (!question) {
                questionInput.focus();
                return;
            }
            if (!ai) {
                alert('Please enter your Google AI API key first.');
                return;
            }

            searchBtn.disabled = true;
            showLoading(question);

            try {
                const prompt = `You are a helpful assistant for Australian university students.

Answer the following question with accurate, up-to-date information about Australian universities, courses, units, enrolment policies, prerequisites, and student services.

Be specific and practical. Use Australian university terminology (e.g. "unit" not "course" for individual subjects, "WAM" for Weighted Average Mark, "EAS" for Educational Access Scheme, "Faculty" for school divisions, etc.).

If the information may change, note that the student should confirm details directly with the university.

Question: ${question}`;

                const response = await ai.models.generateContent({
                    model: "gemini-2.0-flash",
                    contents: [{ text: prompt }],
                    config: {
                        tools: [{ googleSearch: {} }]
                    }
                });

                const answerText = response.text;
                const candidate = response.candidates?.[0];
                const grounding = candidate?.groundingMetadata;
                const chunks = grounding?.groundingChunks || [];
                const searchQueries = grounding?.webSearchQueries || [];

                displayResults(question, answerText, chunks, searchQueries);

            } catch (err) {
                console.error('Search error:', err);
                resultsArea.innerHTML = `
                    <div class="error-card">
                        <strong>Something went wrong.</strong><br>
                        ${err.message || 'Please check your API key and try again.'}
                    </div>`;
            }

            searchBtn.disabled = false;
        }

        function showLoading(question) {
            resultsArea.innerHTML = `
                <div class="loading-state">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">Searching the web for your answer‚Ä¶</div>
                    <div class="loading-subtext">Running live Google Search queries</div>
                </div>`;
        }

        function displayResults(question, answerText, chunks, searchQueries) {
            const queriesHTML = searchQueries.length > 0 ? `
                <div class="queries-row">
                    <span class="queries-label">Searched for:</span>
                    ${searchQueries.map(q => `<span class="query-chip">üîç ${escHtml(q)}</span>`).join('')}
                </div>` : '';

            const sourcesHTML = chunks.length > 0 ? `
                <div class="sources-section">
                    <div class="sources-heading">
                        Sources <span class="source-count">${chunks.length}</span>
                    </div>
                    <div class="sources-grid">
                        ${chunks.map(chunk => {
                            const web = chunk.web || {};
                            const url = web.uri || '#';
                            const title = web.title || url;
                            let domain = '';
                            try { domain = new URL(url).hostname.replace('www.', ''); } catch {}
                            return `
                            <a class="source-card" href="${escHtml(url)}" target="_blank" rel="noopener">
                                <div class="source-title-text">
                                    <img class="source-favicon"
                                         src="https://www.google.com/s2/favicons?domain=${escHtml(domain)}&sz=32"
                                         onerror="this.style.display='none'"
                                         alt="">
                                    ${escHtml(title)}
                                </div>
                                <div class="source-url-text">${escHtml(domain)}</div>
                            </a>`;
                        }).join('')}
                    </div>
                </div>` : '';

            const noSourcesNote = chunks.length === 0 ? `
                <p style="color:#aaa; font-size:0.82rem; margin-top:12px;">
                    No search source metadata returned for this query.
                </p>` : '';

            resultsArea.innerHTML = `
                <div class="answer-card">
                    <div class="answer-label">üìñ Answer</div>
                    <div class="answer-text">${escHtml(answerText)}</div>
                </div>
                ${queriesHTML}
                ${sourcesHTML}
                ${noSourcesNote}
                <div class="disclaimer">
                    ‚ö†Ô∏è <strong>Important:</strong> This information is sourced from live web results and may not reflect the most recent policy changes. Always confirm enrolment details, prerequisite requirements, and deadlines directly with your university's student portal or faculty office.
                </div>`;
        }

        function escHtml(str) {
            return String(str)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;');
        }
    </script>
</body>
</html>
