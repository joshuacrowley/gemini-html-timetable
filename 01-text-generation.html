<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uni Study Planner — Australian Universities</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a2a4a 0%, #2d4a7a 100%);
            min-height: 100vh;
            padding: 24px 16px;
        }

        .container {
            max-width: 820px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 24px 48px rgba(0, 0, 0, 0.25);
            overflow: hidden;
        }

        /* ── Header ──────────────────────────────────────────── */
        .header {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5986 100%);
            color: white;
            padding: 32px 36px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -40px;
            right: -40px;
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: -60px;
            right: 80px;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.04);
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .header-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 4px 12px;
            font-size: 0.75rem;
            font-weight: 500;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            margin-bottom: 16px;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .header p {
            opacity: 0.8;
            font-size: 1rem;
            font-weight: 300;
            line-height: 1.5;
        }

        /* ── API Key Section ─────────────────────────────────── */
        .api-key-section {
            padding: 20px 36px;
            background: #f7f9fc;
            border-bottom: 1px solid #e8edf4;
        }

        .api-key-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: #5a6a7e;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
        }

        .api-key-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #apiKeyInput {
            flex: 1;
            padding: 10px 14px;
            border: 2px solid #dce4ef;
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: inherit;
            color: #333;
            background: white;
            transition: border-color 0.2s;
        }

        #apiKeyInput:focus {
            outline: none;
            border-color: #2d5986;
        }

        #saveApiKey {
            padding: 10px 20px;
            background: #2d5986;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            font-family: inherit;
            white-space: nowrap;
            transition: background 0.2s;
        }

        #saveApiKey:hover {
            background: #1e3a5f;
        }

        .api-status {
            margin-top: 8px;
            font-size: 0.8rem;
            color: #7a8a9e;
        }

        .api-status.success {
            color: #2a7a4f;
            font-weight: 500;
        }

        .api-status.error {
            color: #c0392b;
        }

        /* ── Content Section ─────────────────────────────────── */
        .content-section {
            padding: 32px 36px;
        }

        /* ── Controls ────────────────────────────────────────── */
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-group label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #3a4a5e;
        }

        .control-group select {
            padding: 11px 14px;
            border: 2px solid #dce4ef;
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: inherit;
            color: #333;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%235a6a7e' stroke-width='2' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 14px center;
            padding-right: 36px;
        }

        .control-group select:focus {
            outline: none;
            border-color: #2d5986;
        }

        /* Temperature slider */
        .slider-wrapper {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.72rem;
            color: #8a9aae;
            margin-top: 2px;
        }

        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: linear-gradient(to right, #2d5986 0%, #2d5986 50%, #dce4ef 50%, #dce4ef 100%);
            outline: none;
            cursor: pointer;
            margin-top: 6px;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2d5986;
            border: 3px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            cursor: pointer;
        }

        .temp-value-display {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .temp-badge {
            background: #eef3fa;
            color: #2d5986;
            font-weight: 600;
            font-size: 0.85rem;
            padding: 2px 10px;
            border-radius: 12px;
            min-width: 44px;
            text-align: center;
        }

        .temp-hint {
            font-size: 0.78rem;
            color: #8a9aae;
            font-style: italic;
        }

        /* ── Quick Prompts ───────────────────────────────────── */
        .quick-prompts-section {
            margin-bottom: 24px;
        }

        .section-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #3a4a5e;
            margin-bottom: 10px;
        }

        .quick-prompts {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .quick-prompt-btn {
            padding: 6px 14px;
            background: #eef3fa;
            color: #2d5986;
            border: 1px solid #c4d4e8;
            border-radius: 20px;
            font-size: 0.8rem;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }

        .quick-prompt-btn:hover {
            background: #2d5986;
            color: white;
            border-color: #2d5986;
        }

        /* ── Prompt Input ────────────────────────────────────── */
        .prompt-section {
            margin-bottom: 24px;
        }

        #promptInput {
            width: 100%;
            min-height: 130px;
            padding: 14px;
            border: 2px solid #dce4ef;
            border-radius: 10px;
            font-size: 0.95rem;
            font-family: inherit;
            color: #333;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.2s;
        }

        #promptInput:focus {
            outline: none;
            border-color: #2d5986;
        }

        /* ── Generate Button ─────────────────────────────────── */
        .generate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5986 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            letter-spacing: 0.3px;
            transition: opacity 0.2s, transform 0.1s;
            margin-bottom: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .generate-btn:hover:not(:disabled) {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .generate-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .generate-btn:disabled {
            background: #b0bec5;
            cursor: not-allowed;
            transform: none;
        }

        /* ── Output Section ──────────────────────────────────── */
        .output-section {
            background: #f7f9fc;
            border: 1px solid #dce4ef;
            border-radius: 12px;
            overflow: hidden;
        }

        .output-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 18px;
            border-bottom: 1px solid #dce4ef;
            background: #eef3fa;
        }

        .output-title {
            font-size: 0.82rem;
            font-weight: 600;
            color: #5a6a7e;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .output-meta {
            font-size: 0.78rem;
            color: #8a9aae;
        }

        .output-body {
            padding: 20px 22px;
            min-height: 180px;
        }

        .output-content {
            white-space: pre-wrap;
            line-height: 1.75;
            font-size: 0.95rem;
            color: #2c3e50;
        }

        .output-placeholder {
            color: #aab4c0;
            font-style: italic;
            font-size: 0.9rem;
        }

        /* Loading animation */
        .loading-dots {
            display: inline-flex;
            gap: 5px;
            align-items: center;
        }

        .loading-dots span {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background: #2d5986;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
        .loading-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); opacity: 0.4; }
            40% { transform: scale(1); opacity: 1; }
        }

        .loading-message {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #5a6a7e;
            font-size: 0.9rem;
        }

        /* Error state */
        .error-message {
            color: #c0392b;
            background: #fdf2f2;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 14px 16px;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* SDK note */
        .sdk-note {
            margin-top: 20px;
            padding: 12px 16px;
            background: #f0f5ff;
            border-left: 3px solid #2d5986;
            border-radius: 0 8px 8px 0;
            font-size: 0.78rem;
            color: #5a6a7e;
            line-height: 1.5;
        }

        .sdk-note code {
            background: #dce8f5;
            padding: 1px 5px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
        }

        /* ── Responsive ─────────────────────────────────────── */
        @media (max-width: 640px) {
            body { padding: 12px; }

            .header { padding: 24px 20px; }
            .header h1 { font-size: 1.5rem; }

            .api-key-section,
            .content-section { padding: 20px; }

            .api-key-group { flex-direction: column; }
            #saveApiKey { width: 100%; }

            .controls { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">

        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="header-badge">
                    <svg width="10" height="10" viewBox="0 0 10 10" fill="currentColor">
                        <circle cx="5" cy="5" r="5"/>
                    </svg>
                    Gemini API · Text Generation
                </div>
                <h1>Uni Study Planner</h1>
                <p>Tell the assistant about your units, assessments, and availability — get a personalised semester study plan powered by Gemini.</p>
            </div>
        </div>

        <!-- API Key -->
        <div class="api-key-section">
            <div class="api-key-label">Google AI API Key</div>
            <div class="api-key-group">
                <input type="password" id="apiKeyInput" placeholder="Paste your Google AI Studio API key…" maxlength="200" autocomplete="off">
                <button id="saveApiKey">Save Key</button>
            </div>
            <div class="api-status" id="apiStatus">Enter your key to unlock the assistant. Get one free at <a href="https://aistudio.google.com/apikey" target="_blank" style="color:#2d5986">aistudio.google.com</a>.</div>
        </div>

        <!-- Main Content -->
        <div class="content-section">

            <!-- Controls -->
            <div class="controls">
                <!-- Temperature -->
                <div class="control-group">
                    <label for="temperatureSlider">
                        Temperature
                        <span style="font-weight:400; color:#8a9aae"> — how creative?</span>
                    </label>
                    <div class="slider-wrapper">
                        <div class="temp-value-display">
                            <span class="temp-badge" id="tempValue">0.5</span>
                            <span class="temp-hint" id="tempHint">Balanced</span>
                        </div>
                        <input type="range" id="temperatureSlider" min="0" max="2" step="0.1" value="0.5">
                        <div class="slider-labels">
                            <span>Strict &amp; structured</span>
                            <span>Creative &amp; flexible</span>
                        </div>
                    </div>
                </div>

                <!-- Assistant style -->
                <div class="control-group">
                    <label for="assistantStyle">Assistant Style</label>
                    <select id="assistantStyle">
                        <option value="structured">Structured Planner</option>
                        <option value="motivational">Motivational Coach</option>
                        <option value="exam">Exam-Focused Tutor</option>
                        <option value="flexible">Flexible Advisor</option>
                        <option value="pomodoro">Pomodoro Specialist</option>
                    </select>
                </div>
            </div>

            <!-- Quick Prompts -->
            <div class="quick-prompts-section">
                <div class="section-label">Quick prompts</div>
                <div class="quick-prompts">
                    <button class="quick-prompt-btn" data-prompt="I have 4 units this semester at UNSW — MKTG1001, ECON1010, STAT1001, and MGMT1001. Lectures are Mon/Wed 9–11am and Tue/Thu 1–3pm, and I have a tute for each unit once a week. I can study about 20 hours a week outside of contact hours. Can you build me a full weekly study timetable?">
                        Full week timetable
                    </button>
                    <button class="quick-prompt-btn" data-prompt="I've got a 2000 word essay due in Week 8 and a mid-sem test in Week 6. It's currently the start of Week 5. How should I structure my study over the next 3 weeks to manage both without burning out?">
                        Essay + mid-sem plan
                    </button>
                    <button class="quick-prompt-btn" data-prompt="I work part-time Thursday and Friday (9am–5pm) at a café. I'm studying 3 units at Monash this semester. Help me fit in study around my work shifts and contact hours across the rest of the week.">
                        Study around part-time work
                    </button>
                    <button class="quick-prompt-btn" data-prompt="My WAM is sitting at 67 and I need to get it above 70 to be eligible for honours. I have 4 units this semester — two I'm doing well in (Distinctions) and two I'm struggling with (Credits). Which units should I prioritise and how?">
                        Boost my WAM for honours
                    </button>
                    <button class="quick-prompt-btn" data-prompt="Swotvac starts next Monday and I have 4 exams: LAWS2250 on Day 3, ECON1010 on Day 5, ACCT1501 on Day 7, and LAWS2255 on Day 10. Help me plan all 5 days of swotvac so I peak for each exam at the right time.">
                        Swotvac revision plan
                    </button>
                </div>
            </div>

            <!-- Prompt Input -->
            <div class="prompt-section">
                <div class="control-group">
                    <label for="promptInput">Your question or situation</label>
                    <textarea id="promptInput" placeholder="Describe your units, assessments, availability, or ask a specific study question…

Example: I'm a second-year Commerce student at UniMelb. This semester I'm doing 4 units — two are heavy on readings, one has a group assignment due Week 10, and one has a final exam worth 70%. I can study 4 hours on weekdays and 6 hours on weekends. Build me a realistic weekly study plan for Semester 2."></textarea>
                </div>
            </div>

            <!-- Generate Button -->
            <button class="generate-btn" id="generateBtn" disabled>
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                    <path d="M2 17l10 5 10-5"/>
                    <path d="M2 12l10 5 10-5"/>
                </svg>
                Generate Study Plan
            </button>

            <!-- Output -->
            <div class="output-section">
                <div class="output-header">
                    <span class="output-title">Response</span>
                    <span class="output-meta" id="outputMeta">—</span>
                </div>
                <div class="output-body">
                    <div class="output-content" id="outputContent">
                        <span class="output-placeholder">Your study plan or schedule advice will appear here…</span>
                    </div>
                </div>
            </div>

            <!-- SDK reference note -->
            <div class="sdk-note">
                <strong>SDK reference:</strong> This demo uses <code>@google/genai</code> (the current unified SDK, replacing the deprecated <code>@google/generative-ai</code>).
                Config options like <code>systemInstruction</code> and <code>temperature</code> are passed inside the <code>config</code> object of <code>ai.models.generateContent()</code>.
            </div>

        </div>
    </div>

    <script type="module">
        import { GoogleGenAI } from "https://esm.sh/@google/genai@latest";

        // ── State ────────────────────────────────────────────────
        let apiKey = localStorage.getItem('googleAiApiKey') || '';
        let ai = null;

        // ── Elements ─────────────────────────────────────────────
        const apiKeyInput     = document.getElementById('apiKeyInput');
        const saveApiKeyBtn   = document.getElementById('saveApiKey');
        const apiStatus       = document.getElementById('apiStatus');
        const temperatureSlider = document.getElementById('temperatureSlider');
        const tempValue       = document.getElementById('tempValue');
        const tempHint        = document.getElementById('tempHint');
        const assistantStyle  = document.getElementById('assistantStyle');
        const promptInput     = document.getElementById('promptInput');
        const generateBtn     = document.getElementById('generateBtn');
        const outputContent   = document.getElementById('outputContent');
        const outputMeta      = document.getElementById('outputMeta');

        // ── System instruction per style ─────────────────────────
        const systemInstructions = {
            structured: `You are a meticulous study planner for Australian university students.
You are familiar with the Australian university system: students enrol in units (not "courses" — a course is the whole degree), attend lectures, tutorials (tutes), and workshops, and are assessed through assignments, essays, lab reports, mid-semester tests, and final exams.
Semesters run across roughly 13 teaching weeks plus a swotvac week before the exam period.
You create clear, hour-by-hour weekly schedules using structured formats (tables or day-by-day time blocks).
When relevant, weight study time by unit difficulty and assessment stakes (e.g. a final exam worth 60% deserves more swotvac time than a unit with continuous assessment).
Always include short breaks, note consultation hours as an option for difficult content, and flag any scheduling conflicts or risks.
Use Australian spelling (e.g. "practise", "organisation", "recognise").`,

            motivational: `You are an energetic and encouraging study coach for Australian uni students.
You understand the real pressures of Australian university life: HECS/HELP debt means failing a unit is costly, WAM matters for honours and graduate programs, and balancing part-time work, residential college life, and social commitments is genuinely hard.
You are familiar with Australian university terminology: units, tutorials (tutes), consultations (not "office hours"), swotvac, mid-sem tests, and the HD/D/C/P/F grading scale.
You help students plan their study time in a way that keeps them motivated and avoids burnout.
You use warm, supportive Australian English, suggest reward systems, and weave in wellbeing tips alongside practical schedules.
Your timetables are realistic and include milestones tied to week numbers in the semester.
Use Australian spelling throughout.`,

            exam: `You are a focused exam and assessment preparation tutor for Australian university students.
You specialise in high-pressure revision planning — spaced repetition, interleaving across units, active recall, and past-paper practice.
You are fluent in Australian university conventions: swotvac is typically one week before the formal exam period; exams are often worth 40–70% of the final grade; the HD/D/C/P/F scale means students need 50% to pass and 85% for a High Distinction.
You create revision timetables that maximise retention in limited time, structured around week numbers and exam dates.
Always prioritise weaker units and suggest specific revision techniques (e.g. practice MCQs, essay plans, flashcards, past papers from the unit's LMS).
When a student mentions WAM or honours eligibility, factor that into which units to prioritise.
Use Australian spelling throughout.`,

            flexible: `You are a flexible and adaptable study advisor for Australian uni students.
You understand that student life is unpredictable — part-time jobs, residential college events, sport commitments, and assessment bunching all disrupt the best-laid plans.
You are familiar with Australian university terminology: units, tutes, consultations, swotvac, week numbers, and the HD/D/C/P/F grading scale.
You build schedules with buffer time, offer alternative options for different scenarios, and help students re-prioritise when things change.
Your advice is practical, non-prescriptive, and respects each student's learning style and personal circumstances.
When a student is at risk of failing (below Pass), gently flag that failing a HECS/HELP unit still incurs the debt and suggest seeking support (student services, tutor consultation, special consideration).
Use Australian spelling throughout.`,

            pomodoro: `You are a Pomodoro technique specialist for Australian university students.
You structure all study sessions in 25-minute focused blocks (Pomodoros) with 5-minute short breaks and a 20-minute long break after every 4 Pomodoros.
You translate any study request — whether it's preparing for a mid-sem test, drafting an essay, working through tutorial questions, or swotvac revision — into a precise Pomodoro schedule.
Label each Pomodoro with the specific unit and task (e.g. "ECON1010 — Week 6 lecture notes", "LAWS2250 — past paper Q3").
You understand Australian university structure: units, tutes, assessments by week number, and the swotvac period before exams.
Use Australian spelling throughout.`
        };

        // ── Temperature hint labels ──────────────────────────────
        function getTempHint(val) {
            const v = parseFloat(val);
            if (v <= 0.3) return 'Very rigid & precise';
            if (v <= 0.6) return 'Balanced';
            if (v <= 1.0) return 'More varied suggestions';
            if (v <= 1.5) return 'Creative & unconventional';
            return 'Highly experimental';
        }

        // Update slider gradient fill
        function updateSlider(value) {
            const pct = (parseFloat(value) / 2) * 100;
            temperatureSlider.style.background =
                `linear-gradient(to right, #2d5986 0%, #2d5986 ${pct}%, #dce4ef ${pct}%, #dce4ef 100%)`;
        }

        // ── Initialization ───────────────────────────────────────
        if (apiKey) {
            apiKeyInput.value = apiKey;
            initializeAI();
        }

        updateSlider(temperatureSlider.value);

        function initializeAI() {
            try {
                ai = new GoogleGenAI({ apiKey });
                apiStatus.innerHTML = '✅ API key saved — ready to plan your timetable!';
                apiStatus.className = 'api-status success';
                generateBtn.disabled = false;
            } catch (error) {
                apiStatus.textContent = '❌ Could not initialise with that key. Please check it and try again.';
                apiStatus.className = 'api-status error';
                generateBtn.disabled = true;
            }
        }

        // ── Event Listeners ──────────────────────────────────────
        saveApiKeyBtn.addEventListener('click', () => {
            apiKey = apiKeyInput.value.trim();
            if (apiKey) {
                localStorage.setItem('googleAiApiKey', apiKey);
                initializeAI();
            } else {
                apiStatus.textContent = 'Please paste a valid API key.';
                apiStatus.className = 'api-status error';
            }
        });

        apiKeyInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') saveApiKeyBtn.click();
        });

        temperatureSlider.addEventListener('input', (e) => {
            const v = e.target.value;
            tempValue.textContent = parseFloat(v).toFixed(1);
            tempHint.textContent = getTempHint(v);
            updateSlider(v);
        });

        // Quick prompt buttons
        document.querySelectorAll('.quick-prompt-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                promptInput.value = btn.dataset.prompt;
                promptInput.focus();
            });
        });

        // ── Generate ─────────────────────────────────────────────
        generateBtn.addEventListener('click', async () => {
            if (!ai) {
                alert('Please save your API key first.');
                return;
            }

            const prompt = promptInput.value.trim();
            if (!prompt) {
                promptInput.focus();
                return;
            }

            generateBtn.disabled = true;
            outputMeta.textContent = 'Generating…';
            outputContent.innerHTML = `
                <div class="loading-message">
                    <div class="loading-dots">
                        <span></span><span></span><span></span>
                    </div>
                    Working out your study plan…
                </div>`;

            const temperature = parseFloat(temperatureSlider.value);
            const style = assistantStyle.value;
            const startTime = Date.now();

            try {
                // ── Key SDK pattern ──────────────────────────────────────
                // @google/genai (new SDK): systemInstruction and temperature
                // both go inside the `config` object — NOT as top-level params.
                // `generationConfig` is the OLD (deprecated) pattern.
                const response = await ai.models.generateContent({
                    model: "gemini-2.5-flash",
                    contents: prompt,
                    config: {
                        systemInstruction: systemInstructions[style],
                        temperature: temperature,
                        maxOutputTokens: 2048,
                    },
                });

                const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                outputContent.textContent = response.text;
                outputMeta.textContent = `Completed in ${elapsed}s · temp ${temperature.toFixed(1)} · ${style}`;

            } catch (error) {
                console.error('Gemini API error:', error);
                const msg = error.message || 'An unexpected error occurred.';
                outputContent.innerHTML = `<div class="error-message">❌ <strong>Error:</strong> ${msg}<br><br>Check that your API key is valid and that you have access to the gemini-2.5-flash model.</div>`;
                outputMeta.textContent = 'Error';
            }

            generateBtn.disabled = false;
        });
    </script>
</body>
</html>
